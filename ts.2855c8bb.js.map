{"mappings":"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","sources":["./src/ts/cell.ts","./src/ts/position.ts","./src/ts/tetrimino.ts","./src/ts/grid.ts","./src/ts/game.ts","./src/ts/app.ts","./src/ts/index.ts"],"sourcesContent":["const FILLED_COLOR = \"#000000\";\nconst EMPTY_COLOR = \"#E0E0E0\";\n\nclass CellOuter {\n  elem: HTMLElement = this.initialElem();\n  inner: CellInner = new CellInner(this.elem);\n\n  constructor(parentElem) {\n    parentElem.appendChild(this.elem);\n  }\n\n  initialElem(): HTMLElement {\n    const elem = document.createElement(\"li\");\n    elem.style.listStyle = \"none\";\n    elem.style.width = \"78%\";\n    elem.style.height = \"78%\";\n    elem.style.border = \"2px solid\";\n    elem.style.display = \"flex\";\n    elem.style.justifyContent = \"center\";\n    elem.style.alignItems = \"center\";\n    return elem;\n  }\n\n  fill() {\n    this.elem.style.borderColor = FILLED_COLOR;\n    this.inner.fill();\n  }\n\n  clear() {\n    this.elem.style.borderColor = EMPTY_COLOR;\n    this.inner.clear();\n  }\n}\n\nclass CellInner {\n  elem: HTMLElement;\n\n  constructor(parentElem) {\n    this.elem = document.createElement(\"div\");\n    parentElem.appendChild(this.elem);\n\n    this.elem.style.width = \"75%\";\n    this.elem.style.height = \"75%\";\n    this.elem.style.backgroundColor = EMPTY_COLOR;\n  }\n\n  fill() {\n    this.elem.style.backgroundColor = FILLED_COLOR;\n  }\n\n  clear() {\n    this.elem.style.backgroundColor = EMPTY_COLOR;\n  }\n}\n\nexport default CellOuter;\n","class Position {\n  x: number;\n  y: number;\n\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n}\n\nexport class AbsolutePosition extends Position {\n  getAbsolute(relativePosition: RelativePosition) {\n    return new AbsolutePosition(\n      this.x + relativePosition.x,\n      this.y + relativePosition.y\n    );\n  }\n}\n\nexport class RelativePosition extends Position {}\n","import { AbsolutePosition, RelativePosition } from \"./position\";\n\nconst tRelativePositions = [\n  new RelativePosition(0, 0),\n  new RelativePosition(-1, 0),\n  new RelativePosition(1, 0),\n  new RelativePosition(0, 1),\n];\n\nclass Tetrimino {\n  centerPosition: AbsolutePosition = new AbsolutePosition(5, 15);\n  occupiedRelativePositions: RelativePosition[];\n  maxX: number;\n\n  constructor(maxX) {\n    this.occupiedRelativePositions = tRelativePositions;\n    this.maxX = maxX;\n  }\n\n  occupiedAbsolutePositions() {\n    return this.occupiedRelativePositions.map((relativePosition) =>\n      this.centerPosition.getAbsolute(relativePosition)\n    );\n  }\n\n  moveDown(): void {\n    this.move(new RelativePosition(0, -1));\n  }\n\n  moveLeft(): void {\n    this.move(new RelativePosition(-1, 0));\n  }\n\n  moveRight(): void {\n    this.move(new RelativePosition(1, 0));\n  }\n\n  move(vector: RelativePosition): void {\n    const nextCenterPosition = this.centerPosition.getAbsolute(vector);\n    if (this.canMoveTo(nextCenterPosition)) {\n      this.centerPosition = nextCenterPosition;\n    }\n  }\n\n  canMoveTo(nextCenterPosition: AbsolutePosition): boolean {\n    const nextAbosolutePositions = this.occupiedRelativePositions.map(\n      (position) => nextCenterPosition.getAbsolute(position)\n    );\n    return this.canBeIn(nextAbosolutePositions);\n  }\n\n  rotateClockwise(): void {\n    this.rotate((position) => new RelativePosition(position.y, -position.x));\n  }\n\n  rotateCounterClockwise(): void {\n    this.rotate((position) => new RelativePosition(-position.y, position.x));\n  }\n\n  rotate(\n    rotateFuction: (position: RelativePosition) => RelativePosition\n  ): void {\n    const nextRelativePositions = this.occupiedRelativePositions.map(\n      rotateFuction\n    );\n    const nextAbsolutePositions = nextRelativePositions.map((position) =>\n      this.centerPosition.getAbsolute(position)\n    );\n    if (this.canBeIn(nextAbsolutePositions)) {\n      this.occupiedRelativePositions = nextRelativePositions;\n    }\n  }\n\n  canBeIn(nextOccupiedAbsolutePositions: AbsolutePosition[]): boolean {\n    return nextOccupiedAbsolutePositions.every(\n      (position) =>\n        0 <= position.x && position.x <= this.maxX && 0 <= position.y\n    );\n  }\n}\n\nexport default Tetrimino;\n","import Cell from \"./cell\";\nimport Tetrimino from \"./tetrimino\";\n\nclass Grid {\n  static HEIGHT = 20;\n  static WIDTH = 10;\n\n  elem: HTMLElement = this.initialElem();\n  cells: Cell[][] = this.initialCells();\n  currentTetrimino: Tetrimino = new Tetrimino(Grid.WIDTH - 1);\n\n  constructor(parentElem) {\n    parentElem.appendChild(this.elem);\n    this.draw();\n    document.addEventListener(\"keydown\", (e) => this.onKeyDown(e));\n  }\n\n  initialElem(): HTMLElement {\n    const elem = document.createElement(\"ul\");\n    elem.style.display = \"grid\";\n    elem.style.gridTemplateColumns = `repeat(${Grid.WIDTH}, 32px)`;\n    elem.style.gridTemplateRows = `repeat(${Grid.HEIGHT}, 32px)`;\n    elem.style.justifyItems = \"center\";\n    elem.style.alignItems = \"center\";\n    return elem;\n  }\n\n  initialCells(): Cell[][] {\n    return Array(Grid.HEIGHT)\n      .fill(null)\n      .map(() =>\n        Array(Grid.WIDTH)\n          .fill(null)\n          .map(() => new Cell(this.elem))\n      );\n  }\n\n  draw() {\n    this.cells.forEach((cellsRow) => cellsRow.forEach((cell) => cell.clear()));\n    this.currentTetrimino\n      .occupiedAbsolutePositions()\n      .forEach((position) =>\n        this.cells[Grid.HEIGHT - 1 - position.y][position.x].fill()\n      );\n  }\n\n  tick(): void {\n    this.currentTetrimino.moveDown();\n    this.draw();\n  }\n\n  onKeyDown(e: KeyboardEvent): void {\n    switch (e.key) {\n      case \"ArrowLeft\":\n        this.currentTetrimino.moveLeft();\n        this.draw();\n        break;\n      case \"ArrowRight\":\n        this.currentTetrimino.moveRight();\n        this.draw();\n        break;\n      case \"d\":\n        this.currentTetrimino.rotateClockwise();\n        this.draw();\n        break;\n      case \"s\":\n        this.currentTetrimino.rotateCounterClockwise();\n        this.draw();\n        break;\n    }\n  }\n}\n\nexport default Grid;\n","import Grid from \"./grid\";\n\nclass Game {\n  elem: HTMLElement = document.createElement(\"div\");\n  grid: Grid = new Grid(this.elem);\n\n  constructor(parentElem) {\n    parentElem.appendChild(this.elem);\n\n    setInterval(() => {\n      this.grid.tick();\n    }, 500);\n  }\n}\n\nexport default Game;\n","import Game from \"./game\";\n\nclass App {\n  game: Game | null;\n  elem: HTMLElement = document.getElementById(\"app\");\n\n  constructor() {\n    this.prepareGame();\n  }\n\n  prepareGame() {\n    this.game = null;\n    document.addEventListener(\"keypress\", () => {\n      if (this.game) return;\n      this.game = new Game(this.elem);\n    });\n  }\n}\n\nexport default App;\n","import App from \"./app\";\n\nwindow.onload = () => new App();\n"],"names":["CellOuter","parentElem","$c1f283888dc145d78e0495992940440$var$_classCallCheck","this","$c1f283888dc145d78e0495992940440$var$_defineProperty","initialElem","CellInner","elem","appendChild","document","createElement","style","listStyle","width","height","border","display","justifyContent","alignItems","borderColor","inner","fill","clear","backgroundColor","Position","x","y","$eb570feff44e7af70ef032f6391057a0$var$_classCallCheck","AbsolutePosition","relativePosition","RelativePosition","tRelativePositions","$eb570feff44e7af70ef032f6391057a0$export$RelativePosition","Tetrimino","maxX","$df028aa2f109c0c2abf209569d4910$var$_classCallCheck","$eb570feff44e7af70ef032f6391057a0$export$AbsolutePosition","occupiedRelativePositions","_this","map","centerPosition","getAbsolute","move","vector","nextCenterPosition","canMoveTo","nextAbosolutePositions","position","canBeIn","rotate","rotateFuction","_this2","nextRelativePositions","nextAbsolutePositions","nextOccupiedAbsolutePositions","_this3","every","Grid","$edff55f5aeba37ebe413d2da667252$var$_classCallCheck","$edff55f5aeba37ebe413d2da667252$var$_defineProperty","initialCells","$df028aa2f109c0c2abf209569d4910$export$default","WIDTH","draw","addEventListener","e","onKeyDown","gridTemplateColumns","concat","gridTemplateRows","HEIGHT","justifyItems","Array","$c1f283888dc145d78e0495992940440$export$default","cells","forEach","cellsRow","cell","currentTetrimino","occupiedAbsolutePositions","moveDown","key","moveLeft","moveRight","rotateClockwise","rotateCounterClockwise","Game","$fffca1628359435431f117ee432fa7b2$var$_classCallCheck","$fffca1628359435431f117ee432fa7b2$var$_defineProperty","$edff55f5aeba37ebe413d2da667252$export$default","setInterval","grid","tick","App","$f4e96cff181c2608286fa3502e43a3e3$var$_classCallCheck","getElementById","prepareGame","game","$fffca1628359435431f117ee432fa7b2$export$default","window","onload","$f4e96cff181c2608286fa3502e43a3e3$export$default"],"version":3,"file":"ts.2855c8bb.js.map"}